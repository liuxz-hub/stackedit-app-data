# 一、驱动开发概括
在学习完三大移植之后，开始学习 Linux 中的三大类驱动：**字符设备驱动**、**块设备驱动**和**网络设备驱动**。

1、字符设备驱动是占用篇幅最大的一类驱动，因为字符设备最多，从最简单的点灯到 I2C、 SPI、音频等都属于字符设备驱动的类型；

2、块设备驱动就是存储器设备的驱动，比如 EMMC、 NAND、 SD 卡和 U 盘等存储设备，这些存储设备的特点是以**存储块（缓存机制）**为基础，数据读写通常是 **成批量** 进行的；

3、网络设备就是网络驱动，主要用于 **数据包（Packet）通信**，通常通过 **协议栈** 进行传输，例如 **TCP/IP、UDP**包括以太网、WiFi、蓝牙。

块设备和网络设备驱动要比字符设备驱动复杂，但厂商一般都已编写封装，大多数情况下可以直接使用的。




# 二、应用程序和驱动的交互原理
1、驱动就是获取外设或传感器数据、控制外设。数据会提交给应用程序。Linux驱动编译既要编写一个驱动，还要编写一个简单的测试应用程序---APP。单片机下驱动和应用都是放到一个文件里面，也就是杂糅到一起。Linux 下驱动和应用是完全分开的。

2、用户空间(用户态)和内核空间(内核态):Linux 操作系统内核和驱动程序运行在内核空间，应用程序运行在用户空间。

3、应用程序想要访问内核资源有三种方法：系统调用、异常(中断)和陷入。应用程序不会直接调用系统调用，而是通过API函数来间接的调用系统调用，比如 POSIXAPI和C库等。unix类操作系统中最常用的编程接口就是 POSIX。每个系统调用都有一个系统调用号。

4、系统调用处于内核空间，应用程序无法直接访问，因此需要“陷入”到内核，方法就是软中断。陷入内核以后还要指定系统调用号来指定调用函数。

<!-- 居中对齐 -->
<div align="center">
  <img src="/imgs/2025-06-11/SGLnFg32HK0muuHz.png" alt="系统调用流程" width="400">
</div>
<!--stackedit_data:
eyJoaXN0b3J5IjpbLTE1MjUyMDE5NywxODYwMzkwNDUsLTM1Nj
Q1OTc4NCwtMTUzMDY3Nzk4OCw4NzkyMzQ4OTMsLTExOTE4OTQ0
MTcsLTc1NTg3NjI0MSwtMjA4ODc0NjYxMl19
-->
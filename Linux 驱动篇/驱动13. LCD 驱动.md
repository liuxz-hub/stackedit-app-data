# 一、LCD 驱动
&emsp;&emsp;在 Linux 下 LCD 的使用广泛，在搭配 QT 这样的 GUI 库下可以制作出非常精美的 UI 界面。
## 1.1 LCD 驱动简析
### 1.1.1 Framebuffer 设备
&emsp;&emsp;fb 是一种机制，将系统中所有跟显示有关的硬件以及软件集合起来，虚拟出一个 fb 设备，当我们编写好 LCD 驱动通过 `Framebuffer` 将底层 LCD 抽象生成一个名为 `/dev/fbX(X=0~n)` 的设备，应用程序通过访问 `/dev/fbX` 这个设备就可以访问 LCD。

&emsp;&emsp;`Framebuffer` 在内核中的表现就是 `fb_info` 的结构体， `fb_info` 结构体包含了 `Framebuffer` 设备的完整属性和操作集合，因此每一个 `Framebuffer` 设备都必须有一个 `fb_info`。

### 1.1.2 LCD 驱动简析
&emsp;&emsp;打开 `imx6ull.dtsi`，然后找到 `lcdif` 节点内容，如下所示：
![输入图片说明](/imgs/2025-07-13/bpUNoZixd9icnvq2.png)

&emsp;&emsp;示例代码中的 `lcdif` 节点信息是所有使用 I.MX6ULL 芯片的板子所共有的，并不是完整的 `lcdif` 节点信息。像屏幕参数这些需要根据不同的硬件平台去添加，比如向 `imx6ullalientek-emmc.dts` 中的 `lcdif` 节点添加其他的属性信息。从示例代码可以看出 `lcdif` 节点的 `compatible` 属性值为`“fsl,imx6ul-lcdif”和“fsl,imx28-lcdif”`，因此在 Linux 源码中搜索这两个字符串即可找到 I.MX6ULL 的 LCD 驱动文件，这个文件为 `drivers/video/fbdev/mxsfb.c`。

&emsp;&emsp;在驱动和设备匹配后，`mxsfb_probe`函数就会执行。

&emsp;&emsp;
<!--stackedit_data:
eyJoaXN0b3J5IjpbLTY1MTA0OTI4NSwtNzczNTYzODMsLTI5NT
M0NDUzMSwxODkwMTk2OTU1LDIyMTQ1NTA2MCw4MTk0MDc0Njdd
fQ==
-->